---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog', ({ data }) => !data.draft);
const tags = [...new Set(allPosts.flatMap((post) => post.data.tags || []))].sort();

// Calculate counts per tag (optional but nice)
const tagCounts = tags.reduce((acc, tag) => {
  acc[tag] = allPosts.filter(p => p.data.tags?.includes(tag)).length;
  return acc;
}, {} as Record<string, number>);
---

<Layout title="Tags - Shedrack Akintayo">
  <div class="container mx-auto max-w-3xl px-4 py-16">
    <header class="py-12">
      <h1 class="text-4xl font-bold tracking-tight">Tags</h1>
      <p class="mt-4 text-muted-foreground">
        Browse all topics and categories.
      </p>
    </header>

    <div class="flex flex-wrap gap-4">
      {tags.map((tag) => (
        <a 
          href={`/tags/${tag}`}
          class="flex items-center gap-2 rounded-lg border border-border bg-card px-4 py-2 transition-colors hover:bg-accent/50 hover:text-accent-foreground"
        >
          <span class="font-medium">#{tag}</span>
          <span class="text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full">
            {tagCounts[tag]}
          </span>
        </a>
      ))}
    </div>
  </div>
</Layout>
